<style>
  @media (max-width: 768px) {
    .navbar-collapse {
      position: fixed;
      top: 0;
      right: -250px;
      width: 250px;
      height: auto;
      max-height: 100vh;
      background-color: #fe424d;
      padding: 1rem;
      transition: right 0.3s ease-in-out;
      z-index: 1050;
    }

    .navbar-collapse.show {
      right: 0;
    }

    .navbar-collapse .nav-link {
      color: white !important;
      margin: 0.5rem 0;
    }

    .navbar-toggler {
      border: none;
    }

    .navbar-toggler:focus {
      outline: none;
      box-shadow: none;
    }

    .close-btn {
      background: transparent;
      border: none;
      color: white;
      font-size: 1.8rem;
      font-weight: bold;
      position: absolute;
      top: 10px;
      right: 15px;
      cursor: pointer;
    }
  }

  .search-box {
    display: flex;
    align-items: center;
    border: 1px solid #ddd;
    border-radius: 50px;
    overflow: hidden;
    background: #fff;
  }

  .search-inp {
    border: none;
    padding: 0.6rem 1rem;
    font-size: 1rem;
    flex: 1;
    outline: none;
  }

  .search-btn {
    background-color: #fe424d;
    color: #fff;
    border: none;
    padding: 0.6rem 1.2rem;
    display: flex;
    align-items: center;
    font-weight: 500;
    cursor: pointer;
  }

  .search-btn i {
    margin-right: 0.5rem;
  }

  .search-btn:hover {
    background-color: #e33a45;
    color: #fff;
  }
</style>

<nav class="navbar navbar-expand-md navbar-light bg-light border-bottom sticky-top">
  <!-- Logo -->
  <a class="navbar-brand" href="/listings">
    <i class="fa-solid fa-compass"></i>
  </a>

  <!-- Explore -->
  <a class="nav-link d-inline-block" href="/listings">Explore</a>

  <!-- Toggler button -->
  <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
    data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false"
    aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <!-- Navbar content -->
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <!-- Close button (only visible on small screens) -->
    <button class="close-btn d-md-none" type="button" onclick="closeSidebar()">
      &times;
    </button>

    <!-- Search bar (hidden on small screens) -->
    <div class="navbar-nav mx-auto d-none d-md-flex">
      <form class="d-flex" role="search">
        <div class="search-box">
          <input class="search-inp" type="search" placeholder="Search Destinations">
          <button class="search-btn" type="submit">
            <i class="fa-solid fa-magnifying-glass"></i> Search
          </button>
        </div>
      </form>
    </div>

    <!-- Right side -->
    <div class="navbar-nav ms-auto">
      <a class="nav-link" href="/listings/new">Host Your Nest</a>
      <% if (!currUser) { %>
        <a class="nav-link" href="/signup"><b>Sign up</b></a>
        <a class="nav-link" href="/login"><b>Login</b></a>
      <% } else { %>
        <a class="nav-link" href="/logout"><b>Logout</b></a>
      <% } %>
    </div>
  </div>
</nav>

<script>
  function closeSidebar() {
    let sidebar = document.getElementById("navbarNavAltMarkup");
    let bsCollapse = bootstrap.Collapse.getInstance(sidebar);
    if (bsCollapse) {
      bsCollapse.hide(); // closes sidebar properly
    }
  }
</script>
